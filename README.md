# BDs
Лабораторные работы по дисциплине "Информационные системы и базы данных" 3 курс ПИиКТ ИТМО

## Лабораторная 1 ##

Для выполнения лабораторной работы №1 необходимо:

1. На основе предложенной предметной области (текста) составить ее описание. Из полученного описания выделить сущности, их атрибуты и связи.

2. Составить инфологическую модель.

3. Составить даталогическую модель. При описании типов данных для атрибутов должны использоваться типы из СУБД PostgreSQL.

4. Реализовать даталогическую модель в PostgreSQL. При описании и реализации даталогической модели должны учитываться ограничения целостности, которые характерны для полученной предметной области.

5. Заполнить созданные таблицы тестовыми данными.


Для создания объектов базы данных у каждого студента есть своя схема. Название схемы соответствует имени пользователя в базе studs (sXXXXXX). Команда для подключения к базе studs:

psql -h pg -d studs

Каждый студент должен использовать свою схему при работе над лабораторной работой №1 (а также в рамках выполнения 2, 3 и 4 этапа курсовой работы).

Отчёт по лабораторной работе должен содержать:

1. Текст задания.

2. Описание предметной области.

3. Список сущностей и их классификацию (стержневая, ассоциация, характеристика).

4. Инфологическая модель (ER-диаграмма в расширенном виде - с атрибутами, ключами...).

5. Даталогическая модель (должна содержать типы атрибутов, вспомогательные таблицы для отображения связей "многие-ко-многим").

6. Реализация даталогической модели на SQL.

7. Выводы по работе.


Темы для подготовки к защите лабораторной работы:

- Архитектура ANSI-SPARC

- Модель "Сущность-Связь". Классификация сущностей. Виды связей. Ограничения целостности.

- DDL

- DML


### Вариант ###

##### Описание предметной области, по которой должна быть построена доменная модель:

```
Залы были заново отделаны со времени его последнего посещения, в них появились некоторые дополнительные удобства.
Маленькие столики со стульями для отдыха, ресторан и почта были тут и раньше, теперь прибавились еще и
парикмахерская, бар, кинотеатр, а также киоск с сувенирами, в котором продавались фотографии и "слайды"
лунных и земных ландшафтови куски "лунников", "рейнджеров" и "сервейоров" с гарантией подлинности,
изящно обрамленные пластиком и грабительски дорогие.
```

[отчёт](lab1/report.md)


## Лабораторная работа №2 ##

Для отношений, полученных при построении предметной области из лабораторной работы No1, выполните следующие действия:
- опишите функциональные зависимости для отношений полученной схемы (минимальное множество);
- приведите отношения в 3NF (как минимум). Постройте схему на основеNF (как минимум). Постройте схему на основе полученных отношений;
- опишите изменения в функциональных зависимостях, произошедшие после преобразования в 3NF (как минимум). Постройте схему на основеNF;
- преобразуйте отношения в BCNF. Докажите, что полученные отношения представлены в BCNF;
- какие денормализации будут полезны для вашей схемы? Приведите подробное описание;

[отчёт](lab2/report.md)


## Лабораторная работа #3

По варианту, выданному преподавателем, составить и выполнить запросы к базе данных "Учебный процесс".

Команда для подключения к базе данных ucheb:

`psql -h pg -d ucheb`

Отчёт по лабораторной работе должен содержать:
- Текст задания.
- Реализацию запросов на SQL.
- Выводы по работе.

Темы для подготовки к защите лабораторной работы:
- SQL
- Соединение таблиц
- Подзапросы

Вариант: 481936

Составить запросы на языке SQL (пункты 1-7).

1. Сделать запрос для получения атрибутов из указанных таблиц, применив фильтры по указанным условиям:\
    Таблицы: Н_ЛЮДИ, Н_СЕССИЯ.\
    Вывести атрибуты: Н_ЛЮДИ.ИД, Н_СЕССИЯ.ИД.\
    Фильтры (AND):\
    a) Н_ЛЮДИ.ФАМИЛИЯ < Афанасьев.\
    b) Н_СЕССИЯ.ИД = 32199.\
    Вид соединения: LEFT JOIN.
2. Сделать запрос для получения атрибутов из указанных таблиц, применив фильтры по указанным условиям:\
    Таблицы: Н_ЛЮДИ, Н_ОБУЧЕНИЯ, Н_УЧЕНИКИ.\
    Вывести атрибуты: Н_ЛЮДИ.ИМЯ, Н_ОБУЧЕНИЯ.ЧЛВК_ИД, Н_УЧЕНИКИ.НАЧАЛО.\
    Фильтры: (AND)\
    a) Н_ЛЮДИ.ИМЯ > Николай.\
    b) Н_ОБУЧЕНИЯ.НЗК < 933232.\
    c) Н_УЧЕНИКИ.ГРУППА > 1100.\
    Вид соединения: RIGHT JOIN.
3. Составить запрос, который ответит на вопрос, есть ли среди студентов группы 3102 люди без ИНН.
4. Выдать различные фамилии студентов и число людей с каждой из этих фамилий, ограничив список фамилиями, встречающимися менее 50 раз на на заочной форме обучения.\
    Для реализации использовать подзапрос.
5. Выведите таблицу со средним возрастом студентов во всех группах (Группа, Средний возраст), где средний возраст больше среднего возраста в группе 3100.
6. Получить список студентов, зачисленных ровно первого сентября 2012 года на первый курс очной формы обучения (специальность: Программная инженерия). В результат включить:\
    номер группы;\
    номер, фамилию, имя и отчество студента;\
    номер и состояние пункта приказа;\
    Для реализации использовать подзапрос с IN.
7. Вывести список людей, не являющихся или не являвшихся студентами ФКТИУ (данные, о которых отсутствуют в таблице Н_УЧЕНИКИ). В запросе нельзя использовать DISTINCT.


--- 

[отчёт](lab3/report.md)



## Лабораторная работа 4 ##

вариант 846532.

Составить запросы на языке SQL (пункты 1-2).

Для каждого запроса предложить индексы, добавление которых уменьшит время выполнения запроса (указать таблицы/атрибуты, для которых нужно добавить индексы, написать тип индекса; объяснить, почему добавление индекса будет полезным для данного запроса).

Для запросов 1-2 необходимо составить возможные планы выполнения запросов. Планы составляются на основании предположения, что в таблицах отсутствуют индексы. Из составленных планов необходимо выбрать оптимальный и объяснить свой выбор.
Изменятся ли планы при добавлении индекса и как?

Для запросов 1-2 необходимо добавить в отчет вывод команды EXPLAIN ANALYZE [запрос]

Подробные ответы на все вышеперечисленные вопросы должны присутствовать в отчете (планы выполнения запросов должны быть нарисованы, ответы на вопросы - представлены в текстовом виде).


1. Сделать запрос для получения атрибутов из указанных таблиц, применив фильтры по указанным условиям:
Таблицы: Н_ЛЮДИ, Н_ВЕДОМОСТИ.
Вывести атрибуты: Н_ЛЮДИ.ИД, Н_ВЕДОМОСТИ.ИД.
Фильтры (AND):
a) Н_ЛЮДИ.ИМЯ = Ярослав.
b) Н_ВЕДОМОСТИ.ИД < 1490007.
Вид соединения: INNER JOIN.
2. Сделать запрос для получения атрибутов из указанных таблиц, применив фильтры по указанным условиям:
Таблицы: Н_ЛЮДИ, Н_ОБУЧЕНИЯ, Н_УЧЕНИКИ.
Вывести атрибуты: Н_ЛЮДИ.ИМЯ, Н_ОБУЧЕНИЯ.НЗК, Н_УЧЕНИКИ.ГРУППА.
Фильтры: (AND)
a) Н_ЛЮДИ.ИМЯ > Александр.
b) Н_ОБУЧЕНИЯ.ЧЛВК_ИД > 113409.
c) Н_УЧЕНИКИ.ГРУППА < 1101.
Вид соединения: RIGHT JOIN.
